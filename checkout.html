<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/image/logo.png" />
    <title>Checkout | Ikeya Naturals</title>
    <style>
        :root {
            --primary: #6B8E23; /* olive green */
            --secondary: #3D2B1F; /* dark brown */
            --accent: #D2B48C; /* light tan */
            --light: #FFF8F0; /* creamy white */
            --gray: #f5f5f5;
            --dark-gray: #777;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Avenir', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: var(--gray);
            color: var(--secondary);
            line-height: 1.6;
        }
        
        /* Header */
        header {
            background-color: var(--light);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 0;
            text-align: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Georgia', serif;
        }
        
        .logo span {
            color: var(--primary);
        }
        
        /* Progress Steps */
        .progress-steps {
            display: flex;
            justify-content: center;
            margin: 30px auto;
            max-width: 800px;
            position: relative;
        }
        
        .progress-steps:before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #ddd;
            z-index: 1;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            width: 33.33%;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #ddd;
            color: var(--secondary);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .step.active .step-number {
            background-color: var(--primary);
            color: var(--light);
        }
        
        .step.completed .step-number {
            background-color: var(--primary);
            color: var(--light);
        }
        
        .step.completed .step-number:after {
            content: 'âœ“';
        }
        
        .step-label {
            font-size: 14px;
            color: var(--dark-gray);
        }
        
        .step.active .step-label {
            color: var(--secondary);
            font-weight: 500;
        }
        
        /* Checkout Container */
        .checkout-container {
            display: flex;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto 50px;
            padding: 0 20px;
        }
        
        @media (min-width: 992px) {
            .checkout-container {
                flex-direction: row;
                gap: 40px;
            }
        }
        
        /* Checkout Form */
        .checkout-form {
            flex: 1;
            background-color: var(--light);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .form-title {
            font-size: 24px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            color: var(--secondary);
            font-family: 'Georgia', serif;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(107,142,35,0.2);
        }
        
        /* Order Summary */
        .order-summary {
            width: 100%;
            margin-top: 30px;
            background-color: var(--light);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        @media (min-width: 992px) {
            .order-summary {
                width: 350px;
                margin-top: 0;
            }
        }
        
        .summary-title {
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            font-family: 'Georgia', serif;
        }
        
        .product-item {
            display: flex;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .remove-item {
            position: absolute;
            top: 0;
            right: 0;
            background: none;
            border: none;
            color: #ff4444;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            transition: all 0.3s ease;
            opacity: 0.7;
        }
        
        .remove-item:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .product-image {
            width: 80px;
            height: 80px;
            border-radius: 4px;
            overflow: hidden;
            margin-right: 15px;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-details {
            flex: 1;
        }
        
        .product-name {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .product-price {
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .quantity-selector {
            display: flex;
            align-items: center;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            background-color: var(--gray);
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .quantity-input {
            width: 50px;
            text-align: center;
            margin: 0 5px;
            padding: 5px;
        }
        
        .summary-totals {
            margin-top: 20px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .total-row:last-child {
            border-bottom: none;
            font-weight: 600;
            font-size: 18px;
        }
        
        /* Payment Methods */
        .payment-methods {
            margin-top: 30px;
        }
        
        .payment-title {
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        /* Pay Button */
        .pay-btn {
            width: 100%;
            background-color: var(--primary);
            color: var(--light);
            border: none;
            padding: 16px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .pay-btn:hover {
            background-color: #7ba52b;
            transform: translateY(-2px);
        }
        
        .pay-btn:active {
            transform: translateY(0);
        }
        
        /* Secure Checkout */
        .secure-checkout {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
            color: var(--dark-gray);
            font-size: 14px;
        }
        
        .secure-checkout svg {
            margin-right: 8px;
            fill: var(--primary);
        }
        
        /* Footer */
        footer {
            background-color: var(--secondary);
            color: var(--light);
            padding: 30px 20px;
            text-align: center;
            margin-top: 50px;
        }
        
        .footer-logo {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--light);
            font-family: 'Georgia', serif;
        }
        
        .footer-logo span {
            color: var(--primary);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .footer-links a {
            color: var(--light);
            text-decoration: none;
            transition: color 0.3s;
            font-size: 14px;
        }
        
        .footer-links a:hover {
            color: var(--accent);
        }
        
        .copyright {
            margin-top: 20px;
            color: #aaa;
            font-size: 12px;
        }
        
        /* Empty Cart */
        .empty-cart {
            text-align: center;
            padding: 40px 0;
            display: none;
        }
        
        .empty-cart p {
            margin-bottom: 20px;
        }
        
        .continue-shopping {
            background-color: var(--primary);
            color: var(--light);
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        
        .continue-shopping:hover {
            background-color: #7ba52b;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="logo">
            <a href="index.html" style="text-decoration: none; color: inherit;">Ikeya<span>Naturals</span></a>
        </div>
    </header>
    
    <div class="progress-steps">
        <div class="step completed">
            <div class="step-number">1</div>
            <div class="step-label">Cart</div>
        </div>
        <div class="step active">
            <div class="step-number">2</div>
            <div class="step-label">Information</div>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <div class="step-label">Payment</div>
        </div>
    </div>
    
    <div class="checkout-container">
        <div class="checkout-form">
            <h2 class="form-title">Shipping Information</h2>
            
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" placeholder="your@email.com" required>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="first-name">First Name</label>
                    <input type="text" id="first-name" placeholder="First Name" required>
                </div>
                <div class="form-group">
                    <label for="last-name">Last Name</label>
                    <input type="text" id="last-name" placeholder="Last Name" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" id="address" placeholder="Street Address" required>
            </div>
            
            <div class="form-group">
                <label for="apartment">Apartment, Suite, etc. (Optional)</label>
                <input type="text" id="apartment" placeholder="Apt 123">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="city">City</label>
                    <input type="text" id="city" placeholder="City" required>
                </div>
                <div class="form-group">
                    <label for="state">State</label>
                    <input type="text" id="state" placeholder="State" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" placeholder="Phone Number" required>
            </div>
            
            <h2 class="form-title" style="margin-top: 40px;">Shipping Method</h2>
            
            <div class="form-group">
                <div class="radio-group" style="margin-bottom: 10px;">
                    <input type="radio" id="standard-shipping" name="shipping" checked>
                    <label for="standard-shipping">Around Lagos (â‚¦2,500) - 1-2 business days</label>
                </div>
                <div class="radio-group">
                    <input type="radio" id="express-shipping" name="shipping">
                    <label for="express-shipping">Outside Lagos (â‚¦4,000) - 2-3 business days</label>
                </div>
            </div>
        </div>
        
        <div class="order-summary">
            <h3 class="summary-title">Your Order</h3>
            
            <div class="products-container">
                <div class="product-item" data-product="botanibutter" data-price="2000">
                    <button class="remove-item" onclick="removeProduct(this)"><i class="fas fa-times"></i></button>
                    <div class="product-image">
                        <img src="/image/image-deng.png" alt="Ikeya BotaniButter">
                    </div>
                    <div class="product-details">
                        <div class="product-name">Ikeya BotaniButter</div>
                        <div class="product-price">â‚¦2,000</div>
                        <div class="quantity-selector">
                            <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                            <input type="text" class="quantity-input" value="1" onchange="validateQuantity(this)">
                            <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="product-item" data-product="herbaloil" data-price="3000">
                    <button class="remove-item" onclick="removeProduct(this)"><i class="fas fa-times"></i></button>
                    <div class="product-image">
                        <img src="/image/image-1.png" alt="Ikeya Herbal Hair Oil">
                    </div>
                    <div class="product-details">
                        <div class="product-name">Ikeya Herbal Hair Oil</div>
                        <div class="product-price">â‚¦3,000</div>
                        <div class="quantity-selector">
                            <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                            <input type="text" class="quantity-input" value="1" onchange="validateQuantity(this)">
                            <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="empty-cart">
                <p>Your cart is empty</p>
                <a href="index.html" class="continue-shopping">Continue Shopping</a>
            </div>
            
            <div class="summary-totals">
                <div class="total-row">
                    <span>Subtotal</span>
                    <span id="subtotal">â‚¦5,000</span>
                </div>
                <div class="total-row">
                    <span>Shipping</span>
                    <span id="shipping">â‚¦2,500</span>
                </div>
                <div class="total-row">
                    <span>Total</span>
                    <span id="total">â‚¦7,500</span>
                </div>
            </div>
            
            <div class="payment-methods">
                <h4 class="payment-title">Payment Method</h4>
                <div class="payment-option active" data-method="paystack">
                    <img src="/image/Paystack.webp" alt="Paystack" style="height: 25px;">
                    <div class="payment-option-name">Paystack</div>
                </div>
                
                <button class="pay-btn" onclick="processPayment()">Pay Now</button>
                
                <div class="secure-checkout">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11V11.99z"/>
                    </svg>
                    Secure Checkout
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="footer-logo">Ikeya<span>Naturals</span></div>
        <div class="copyright">
            Â© 2023 Ikeya Naturals. Handcrafted in Nigeria with love.
        </div>
    </footer>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5PGF1LFF1C"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-5PGF1LFF1C');
    </script>
    
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
    </script>
    <script type="text/javascript">
        (function(){
            emailjs.init({
                publicKey: "o_XZGriQaTyIRXJ_j",
            });
        })();
    </script>
    <script>
        // Product data
        const products = {
            botanibutter: { price: 2000, quantity: 1 },
            herbaloil: { price: 3000, quantity: 1 }
        };
        
        let shippingCost = 2500;
        const paymentMethod = 'paystack'; // Default to Paystack
        
        // Update quantity functions
        function updateQuantity(button, change) {
            const input = button.parentElement.querySelector('.quantity-input');
            let newValue = parseInt(input.value) + change;
            if (newValue < 1) newValue = 1;
            input.value = newValue;
            
            const productItem = button.closest('.product-item');
            const productId = productItem.dataset.product;
            products[productId].quantity = newValue;
            
            updateTotals();
        }
        
        function validateQuantity(input) {
            let value = parseInt(input.value);
            if (isNaN(value) || value < 1) {
                input.value = 1;
                value = 1;
            }
            
            const productItem = input.closest('.product-item');
            const productId = productItem.dataset.product;
            products[productId].quantity = value;
            
            updateTotals();
        }
        
        // Remove product function
        function removeProduct(button) {
            const productItem = button.closest('.product-item');
            const productId = productItem.dataset.product;
            
            // Remove from products object
            delete products[productId];
            
            // Remove from DOM with animation
            productItem.style.transition = 'all 0.3s ease';
            productItem.style.opacity = '0';
            productItem.style.height = productItem.offsetHeight + 'px';
            
            setTimeout(() => {
                productItem.remove();
                updateTotals();
                
                // Check if cart is empty
                if (Object.keys(products).length === 0) {
                    document.querySelector('.products-container').style.display = 'none';
                    document.querySelector('.summary-totals').style.display = 'none';
                    document.querySelector('.payment-methods').style.display = 'none';
                    document.querySelector('.empty-cart').style.display = 'block';
                    
                    // Redirect after a short delay
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 2000);
                }
            }, 300);
        }
        
        // Update order totals
        function updateTotals() {
            let subtotal = 0;
            
            // Calculate subtotal from products
            for (const productId in products) {
                subtotal += products[productId].price * products[productId].quantity;
            }
            
            // Get selected shipping method
            const expressShipping = document.getElementById('express-shipping').checked;
            shippingCost = expressShipping ? 4000 : 2500; // â‚¦4,000 for outside Lagos, â‚¦2,500 for Lagos
            
            const total = subtotal + shippingCost;
            
            // Update displayed totals
            document.getElementById('subtotal').textContent = `â‚¦${subtotal.toLocaleString()}`;
            document.getElementById('shipping').textContent = `â‚¦${shippingCost.toLocaleString()}`;
            document.getElementById('total').textContent = `â‚¦${total.toLocaleString()}`;
        }
        
        // Shipping method selection
        document.querySelectorAll('input[name="shipping"]').forEach(option => {
            option.addEventListener('change', updateTotals);
        });
        
        // Process payment
        function processPayment() {
            const requiredFields = ['email', 'first-name', 'last-name', 'address', 'city', 'state', 'phone'];
            let isValid = true;
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.style.borderColor = '#ff4444';
                    isValid = false;
                } else {
                    field.style.borderColor = '#ddd';
                }
            });
            
            if (!isValid) {
                alert('Please fill in all required fields.');
                return;
            }
            
            if (Object.keys(products).length === 0) {
                alert('Your cart is empty.');
                return;
            }
            
            let subtotal = 0;
            for (const productId in products) {
                subtotal += products[productId].price * products[productId].quantity;
            }
            const total = subtotal + shippingCost;
            
            const customerData = {
                email: document.getElementById('email').value,
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                address: document.getElementById('address').value,
                apartment: document.getElementById('apartment').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                phone: document.getElementById('phone').value,
                shippingMethod: document.querySelector('input[name="shipping"]:checked').nextElementSibling.textContent,
                products: {...products},
                subtotal: subtotal,
                shipping: shippingCost,
                total: total
            };
            
            processPaystackPayment(customerData);
        }
        
        // Paystack payment processing
        function processPaystackPayment(customerData) {
            const handler = PaystackPop.setup({
                key: 'pk_live_a7e48ef08d1bdf092e3aa12efb41d4bac3ff2255', // Replace with your Paystack public key
                email: customerData.email,
                amount: customerData.total * 100, // Paystack amount is in kobo
                currency: 'NGN',
                ref: 'IK' + Math.floor(Math.random() * 1000000000 + 1),
                callback: function(response) {
                    customerData.paymentReference = response.reference;
                    logOrderAndSendEmail(customerData);
                    alert('Payment successful! Thank you for your purchase.');
                    
                    const formattedAddress = [
                        customerData.address,
                        customerData.apartment ? customerData.apartment : '',
                        `${customerData.city}, ${customerData.state}`,
                        'Nigeria'
                    ].filter(Boolean).join('<br>');

                    const params = new URLSearchParams({
                        total: `â‚¦${customerData.total.toLocaleString()}`,
                        payment: 'Paystack',
                        address: formattedAddress,
                        orderNumber: response.reference
                    });
                    window.location.href = `thank-you.html?${params.toString()}`;
                },
                onClose: function() {
                    alert('Payment window closed');
                }
            });
            handler.openIframe();
        }
        
        // Log order and send email (simulated)
        function logOrderAndSendEmail(customerData) {
            
            emailjs.send('service_s413k7c', 'template_wzlbfha', {
                name: customerData.name,
                to_name: "Favour",
                from_name: customerData.firstName,
                email: "mordecaifavour316@gmail.com",
                subject: "You got a new Order",
                message: `
                    Customer Details:
                    - Email: ${customerData.email}
                    - Phone: ${customerData.phone}
                    - Address: ${customerData.address}, ${customerData.apartment}
                    - City: ${customerData.city}
                    - State: ${customerData.state}

                    Shipping Method: ${customerData.shippingMethod}

                    Order Summary:
                    ${Object.entries(customerData.products).map(([product, details]) => 
                        `- ${product}: â‚¦${details.price} x ${details.quantity} = â‚¦${details.price * details.quantity}`
                    ).join('\n')}

                    - Subtotal: â‚¦${customerData.subtotal}
                    - Shipping: â‚¦${customerData.shipping}
                    - Total: â‚¦${customerData.total}

                    Payment Reference: ${customerData.paymentReference}
                `
            })
            .then(response => {
                console.log('Email sent!', response.status, response.text);
            }, error => {
                console.error('Failed to send email:', error);
            });
        }
    </script>
</body>
</html>